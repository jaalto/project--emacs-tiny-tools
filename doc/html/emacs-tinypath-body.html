<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN"
  "http://www.w3.org/TR/REC-html40/frameset.dtd">
<HTML>
<!---
        See unix what(1) and ident(1) why those funny tags
        @(#) Document: http://tiny-tools.sourceforge.net
        @(#) Contact : Jari Aalto jari.aalto@poboxes.com
        The LINK tags are used by advanced browsers. The BASE signifies
        true location of the original document, and mirrored site
        location. It is where the #TAG go when you define them.
--->
<HEAD>
<TITLE>
No title
</TITLE>
  <BASE HREF="http://tiny-tools.sourceforge.net/emacs-tinypath-body.html" >


<!---	......................................................................
	META TAGS (FOR SEARCH ENGINES)
	......................................................................
--->

  <META HTTP-EQUIV="Expires" CONTENT="Wed,  3 Oct 2001 13:51:44 GMT">

  <META HTTP-EQUIV="Author"
	CONTENT="Jari Aalto">


  <META HTTP-EQUIV="Made"
	CONTENT="mailto:jari.aalto@poboxes.com">


  <META NAME="Generator"
	CONTENT="2001-08-04 16:51 Perl 5 program t2html.pl v1.27 available at http://www.cpan.org/modules/by-authors/id/J/JA/JARIAALTO/">



<!---	......................................................................
	BUTTON DEFINITION START
	......................................................................
--->

  <A HREF="http://tiny-tools.sourceforge.net/"  target="_top" class="btn" >[Previous]</A>

    <STYLE TYPE="text/css">


        <!-- ................................................... Notes

            *** NOTE *** NOTE *** NOTE *** NOTE *** NOTE *** NOTE *** NOTE

            This is the default CSS 2.0 generated by the program,
            please see "t2html.pl --help" for option --script-file
            to import your own CSS and Java definitions into the page.

            *** NOTE *** NOTE *** NOTE *** NOTE *** NOTE *** NOTE *** NOTE



            Comments on the CSS tags:

            -   block-width: "thin" (Netscape ok, MSIE nok)

            NETSCAPE 4.05

            -  In general does not render CSS very well. Eg
               font size changes does not show up in screen.
            -  :hover property is not recognised

            NETSCAPE 4.75 as of 2000-10-01

            -  Shows garbage for stylesheet section that marked CITATION.
               (IE has no trouble to show it)

            MSIE 4.0+

            - Renders CSS very well.

            Media types

            - Netscape does not transfer the CSS element definitions to
              the "print" media as it should. They only affect Browser
              or media "screen"
            - That is why you really have to say <EM><STRONG>...</STRONG><EM>
              to get that kind of text seen in printer too. You cannot
              just define P.column7 { ... }

            The @media CSS definition is not supported by Netscape 4.05
            I do not know if MSIE 4.0 supports it.

            So doing this would cause CSS to be ignored completely
            (never mind that CSS says the default CSS applies to "visual",
            which means both print and scree types.)

                @media print, screen {  P.code {..}  }

            To work around that, we separate the definitions with

                P.code { .. }               // For screen

                @media print { P.code      // for printer
                {
                    ..
                }}

            And wish that some newer browser will render it right.

        -->


        <!-- .......................... Make pointing AHREF more visual -->

        BODY
        {
            font-family: "Times New Roman", serif;;
            

            /*
                More readable font, Like Arial in MS Word
                The background color is grey

                font-family: "verdana", sans-serif;
                background-color: #dddddd;
                foreground-color: #000000;

                Traditional "Book" and newspaper font
                font-family: "Times New Roman", serif;
            */
        }

        A:link
        {
            font-style: italic;
        }

        /*   <A NAME=...> link references */

        A.name
        {
            font-style: normal;
        }

        A:hover
        {
            color:           purple;
	    background:      #AFB
            text-decoration: none;
            font-weight:     italic;
        }

            <!-- cancel above italic in TOC and Navigation buttons -->

        A.btn:link
        {
            font-style: normal;
        }

            <!-- each link in TOC -->

        A.toc:link
        {
            font-style: normal;
        }

            <!-- [toc] heading button which appears in non-frame html -->

        A.btn-toc:link
        {
            font-style: normal;
            font-size:  0.7em;
        }

        <!-- .................................... Format the code sections -->

        <!-- MSIE ok, Netscape nok: Indent text to same level to the right -->

        BLOCKQUOTE
        {
            margin-right: 0;
        }

        @media print   { BLOCKQUOTE
        {
            margin-right: 0;
        }}

        SAMP.code
        {
            color: Navy;
        }

        PRE
        {
            font-family:   "Courier New", monospace;
            font-size:     0.8em;
        }

        PRE.code, P.code1, P.code2
        {
            /*
               margin-top:     0.4em;
               margin-bottom:  0.4em;
               line-height:    0.9em;
            */

            font-family:    "Courier New", monospace;
            font-size:      0.8em;

            color:          Navy;
        }

        <!-- ............................................. Format columns -->

        P.column3
        {
            color: Green;
        }

        P.column5
        {
            color: #87C0FF;   /* shaded casual blue */
        }

        P.column6
        {
            color: #809F69;   /* Forest green */
        }

            <!-- This is so called 3rd heading -->

        P.column7
        {
            font-style:  italic;
            font-weight: bold
        }

        @media print { P.column7
        {
            font-style:  italic;
            font-weight: bold
        }}

        P.column8
        {

        }

        P.column9
        {
            font-weight: bold
        }

        P.column10
        {
            padding-top: 0;
        }

        EM.quote10
        {
            /*
                #FF00FF Fuchsia;
                #0000FF Blue

                #87C0FF casual blue
                #87CAF0

		#A0FFFF Very light blue

                #809F69 = Forest Green , see /usr/lib/X11/rgb.txt

		background-color:

                color: #80871F ; Orange, short of

                # font-family: "Gill Sans", sans-serif;

		#  See a nice page at
		#  http://www.cs.helsinki.fi/linux/
		#  http://www.cs.helsinki.fi/include/tktl.css
		#
		#  3-4 of these first fonts have almost identical look
		#  Browser will pick the one that is supported

		line-height: 0.9em;
                font-style:  italic;
	        font-size:   0.8em;

	        line-height: 0.9em;
	        color: #008080;

	        background-color: #F5F5F5;
		#809F69; forest green
		#F5F5F5; Pale grey
		#FFf098; pale green
		##bfefff; #ffefff; LightBlue1


             */

                font-family: lucida, lucida sans unicode, arial, helvetica, sans-serif;
	     background-color: #ffefff;
	     font-size:   0.8em;
        }

        @media print { EM.quote10
        {
            font-style:  italic;
            line-height: 0.9em;
            font-size:   0.8em;
        }}

        P.column11
        {
            color: Fuchsia;
        }


        <!-- ............................................... Format words -->

        EM.word          { color: #809F69;  /*Forest green */ }
        STRONG.word      { }

        SAMP.word
	{
	    color: Blue;
            font-family:    "Courier New", monospace;
            font-size:      0.8em;

	}


        SPAN.word-ref    { color: Teal;  }
        BIG.word-big     { color: Teal; font-size: 1.2em; }
        SMALL.word-small { color: Teal; font-size: 0.8em; }

        <!-- ............................................... Format other -->

                <!-- 7th column starting with double quote -->

        EM.quote7
        {
            color: Green;
            font-style: italic;
        }

                <!-- This appears in FRAME version: xxx-toc.html -->

        DIV.TOC
        {
            font-size: 0.8em;
        }

                <!--  This is the Copyright and html document info footer -->

        EM.footer
        {
            font-size: 0.9em;
        }

    </STYLE>


    </STYLE>

    <!-- ...................................................... Java code -->

    <SCRIPT TYPE="text/javascript">

        function MakeVisual(obj)
        {
            obj.style.fontWeight = "italic";
        }

        function MakeNormal(obj)
        {
            obj.style.fontWeight = "normal";
        }

        function IgnoreErrors()
        {
            return true;
        }

        window.onerror = IgnoreErrors;

    </SCRIPT>

</HEAD>

<BODY >
</BLOCKQUOTE>
<hr>
    <A NAME="tinypath.el__manage_your_emacs_startup">
    <H1>
    1.0 Tinypath.el --- Manage your Emacs startup dynamically
    
    </H1>
    </A>
<BLOCKQUOTE>

<A NAME="preface">
  <H2>
      1.1 Preface
      
  </H2>
</A>


        This is HTML documentation of tinypath.el v1.68 as of 2001-01-29
        which has been generated from plain text file with the help of two
        perl tools available at nearest perl CPAN at
        <A HREF="http://www.perl.com/CPAN-local/scripts/" target="_top">http://www.perl.com/CPAN-local/scripts/</A> or
        <A HREF="http://www.cpan.org/modules/by-authors/id/J/JA/JARIAALTO/" target="_top">http://www.cpan.org/modules/by-authors/id/J/JA/JARIAALTO/</A>

<PRE class="code">
      % ripdoc.pl tinypath.el | t2html.pl &gt; tinypath.html
</PRE>


<A NAME="the_very_fast_start">
  <H2>
      1.2 The very fast start
      
  </H2>
</A>


        If you really insist doing the reading later, here is what to do.
        No guarrantees that this will work. Then you better read docs.
<P><UL>
	<LI>Include perl script <EM class="word">emacs-util.el</EM> in your <SAMP class="word">PATH</SAMP>. If you
            do not have perl, get it at <A HREF="http://www.perl.com/" target="_top">http://www.perl.com/</A> or
            win32 <A HREF="http://www.activestate.com/" target="_top">http://www.activestate.com/</A>
	<LI>If you use XEmacs, see <SAMP class="word">tinypath-:core-emacs-load-path-list</SAMP>
	<LI>If you use private Gnus (not gnus from Emacs dist) YOU MUST
            SET <SAMP class="word">tinypath-:ignore-file-regexp-extra</SAMP>.
	<LI>Move all your private lisp under $HOME/elisp
	<LI>Create directory <SAMP class="word">$HOME/elisp/config</SAMP> for cache location.
	<LI>Load <EM class="word">tinypath.el</EM> like this, please copy verbatim:
</UL>



<PRE class="code">
      ;; $HOME/.emacs
      (require 'cl)
      ;; location of tinypath.el
      (pushnew &quot;~/elisp/tiny/lisp&quot; load-path :test 'stringp=)
      (load &quot;tinypath.el&quot;)
</PRE>


<P class="column8">
	<P><UL>
	<LI>After Emacs is up, call <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypath-cache-problem-report</SAMP>
</UL>



<A NAME="first_user_note">
  <H2>
      1.3 First user note
      
  </H2>
</A>


        You may see message &quot;Tinypath: EXT Process running ...
        <SPAN class="word-ref">[may takea while]</SPAN>&quot; and Emacs hangs for a while when you use this
        package for the first time. Please wait and read the documentation
        about &quot;Faster Emacs configuration&quot; later in this file.
        At any time you can read the manual with <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypath-version</SAMP>
        Gnus users, read section from manual below (highly important).

<P class="column8">
        It is important that you use the EXT method, because the old lisp
        method is present only for backward compatibility. Old lisp method
        also has drawback, that it does not support rearranging paths to
        order: 1) $HOME 2) site-lisp-files 3) core-emacs-lisp-files

<P class="column8">
        This new method guarantees, that anything you put into your
        private ~/elisp will override and precede any other package
        found elswhere in <SAMP class="word">load-path</SAMP> hierarchy.

<A NAME="emacs_lisp_install">
  <H2>
      1.4 Emacs Lisp install
      
  </H2>
</A>


        Put this file on your Emacs-Lisp load path, add following into your
        $HOME/.emacs startup file.

<PRE class="code">
      ;; NO SYMLINK DIRS HERE, THEY ARE IGNORED!
      (setq tinypath-:load-path-root '(&quot;~/elisp&quot; .. ))
      ;;
      ;; If you use XEmacs
      ;;
      (setq  tinypath-:core-emacs-load-path-list
               '(&quot;/usr/local/share/xemacs/xemacs-packages&quot;
                 &quot;/usr/local/share/xemacs/site-packages&quot;
                 &quot;/usr/local/share/xemacs/mule-packages&quot;
                 ..))
      ;; BELOW, PLEASE USE ABSOLUTE PATH, THERE ARE OPTIMIZATIONS
      ;; THAT ACTIVATE If YOU ADD THE PATH
      (require 'cl)
      (pushnew &quot;~/elisp/tiny/lisp&quot; load-path :test 'stringp=)
      (load &quot;tinypath.el&quot;)
</PRE>


<A NAME="cache_file_location">
  <H2>
      1.5 Cache file location
      
  </H2>
</A>


        Create directory where to cache information is saved by default or
        change <SAMP class="word">tinypath-:cache-file-prefix</SAMP> which should be pathname +
        file-prefix. The cache size depends on your installed files, with
        600 directories and 8000 lisp files, the cache size is around 500k
        and if you use compression, it takes somewhere 200k.

<PRE class="code">
      % mkdir -p ~/elisp/config
</PRE>


<A NAME="transparent_compression">
  <H2>
      1.6 Transparent compression
      
  </H2>
</A>


        This package supports transparent compression, where you can keep
        your files in compressed format without touching the code in your
        emacs startup files. These calls are interpreted as if there were
        <SAMP class="word">.el.gz</SAMP> extension attached to files. IMPORTANT: If you compress or
        decompress a lisp file, always update the cache immediately with
        <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypath-cache-regenerate</SAMP>.

<PRE class="code">
      (load &quot;some-file&quot;)
      (require 'somefile)
</PRE>


<A NAME="contact_and_support">
  <H2>
      1.7 Contact and support
      
  </H2>
</A>


        You should pump up the <SAMP class="word">tinypath-:verbose</SAMP> level to 10 if you think
        there is something odd going on. All the messages will appear in
        Emacs <EM class="word">Message</EM> buffer. If you have any questions, use this
        function to contact maintainer <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypath-submit-bug-report</SAMP>.
        and send the <EM class="word">Message</EM> buffer content.

<P class="column8">
        <EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*

<P class="column8">
        IT IS HIGHLY RECOMMENDED THAT YOU VALIDATE YOUR SETUP AFTER YOU
        HAVE LOADED THIS PACKAGE

<P class="column8">
        Start Emacs and call report function to investigate any problems,
        like duplicate packages that shadow each other. See documentation
        below for more. The general rule is that you should delete any
        offending packages (use <SAMP class="word">C-d</SAMP> to delete file on line)

<PRE class="code">
      C-u M-x tinypath-cache-problem-report (or without C-u argument)
</PRE>


<P class="column8">
        <EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>*<EM class="word">*</EM>
</BLOCKQUOTE>
<hr>
    <A NAME="feature_description">
    <H1>
    2.0 Feature description
    
    </H1>
    </A>
<BLOCKQUOTE>

<A NAME="how_it_all_begun">
  <H2>
      2.1 How it all begun
      
  </H2>
</A>


        When you have set up your Emacs installation to your liking, a day
        comes when you decide that it's time to seriously reconsider the
        directory structure of your installed lisp packages. It is customary
        to use simple file hierarchy where all private packages are installed
        under:

<PRE class="code">
      ~/elisp   ;; some people also prefer ~/lisp
</PRE>


<P class="column8">
        Complete kits are usually installed directly under the root:

<PRE class="code">
      ~/elisp/bbdb-2.00.06/
      ~/elisp/psgml-1.0.3/
      ~/elisp/pcl-cvs-2.9.2/
</PRE>


<P class="column8">
        A more sophisticated way is to use symlinks to the latest
        versions, so that you don't have to change <SAMP class="word">load-path</SAMP> every
        time you install a new version. It is only matter of updating
        the symlink:

<PRE class="code">
      ~/elisp/pcl-cvs/  --&gt; ~/elisp/pcl-cvs-2.9.2/
      |
      This path is in the `load-path'
</PRE>


<P class="column8">
        In windows world you may have your <STRONG class="word">H:</STRONG> disk mounted to Unix <STRONG class="word">$HOME</STRONG>:

<PRE class="code">
      H:  --&gt; Unix $HOME  \\SERVER\DIRECTORY\YOUR-LOGIN-DIR
</PRE>


<P class="column8">
        Now, there is a catch when you use Unix symlinks in <SAMP class="word">$HOME/elisp</SAMP>
        and try to access the directories from Windows. Having set PC's
        HOME environment variable to point to H:, NTEmacs start reading
        Unix <SAMP class="word">$HOME/.emacs</SAMP> startup file. After some win32 configuration
        Emacs was up for win32. Well, almost. It started with simple error
        messages &quot;Can't load library xxx&quot;, soon followed by bigger
        concerns: &quot;autoloading xxx failed&quot;. The problem was the mounted H:
        disk. You see, PC's network mount can't distinguish symlinked
        directories from real directories, so all symlinked Unix
        directories in <SAMP class="word">load-path</SAMP> were dead. And that's why most of the
        files were not found any more. (symlinks were used to avoid
        changing <SAMP class="word">load-path</SAMP> every time a new package was installed).

<P class="column7"><EM><STRONG>
       2.1.1 And the conclusions</STRONG></EM>


<P class="column8">
        For cross platform solution it is best not to rely on symlinks,
        because they don't work over a Windows mount. Secondly,
        updating <SAMP class="word">load-path</SAMP> should not be needed by hand after a new
        package installation, after a directory name change, after
        directory structure change, etc. A dream package would solve this
        all and do the hard work: &quot;There, that is the root(s) of all Emacs
        lisp, go and sniff all the directories and update <SAMP class="word">load-path</SAMP>&quot;
        That was what this package originally was all about. Nowadays it
        does a little more than that. Your <SAMP class="word">load-path</SAMP> is updated
        automatically without any manual work. You only have to give the
        start ROOT path(s) of your installed lisp hierarchies in the file
        system. This package is highly effective: scanning thousends of
        files in a matter of seconds and once the cache has been created,
        it takes only a snap to load it in next sessions. All <SAMP class="word">require</SAMP> and
        <SAMP class="word">load</SAMP> commands execute also faster than previously, because the
        information about existing files is immediately available. The
        speedup is helped through adviced functions.

<A NAME="overview_of_features">
  <H2>
      2.2 Overview of features
      
  </H2>
</A>



<P class="column7"><EM><STRONG>
       2.2.1 Automatic load-path configuration</STRONG></EM>

<P><UL>
	<LI>Define list of <SAMP class="word">root</SAMP> directories of your Emacs lisp and this
            package will recursively add directories which contain .el or
            .elc files to <SAMP class="word">load-path</SAMP>
	<LI>A cache is utilized to remember previous scan and
            expired periodically. Using cache speeds up loading files
            considerably if you have many directories. The number of lisp
            directories doesn't affect the load performance any more.
            This is accomplished by using extra advice code in functions:
            <SAMP class="word">load</SAMP>, <SAMP class="word">load-library</SAMP>, <SAMP class="word">require</SAMP>, <SAMP class="word">locate-library</SAMP> and
            <SAMP class="word">autoload</SAMP>.
	<LI>When Emacs becomes idle (some 15 minutes of idle time) the
            cache and <SAMP class="word">load-path</SAMP> is validated for errourneous entries and
            rebuilt as needed. This feature should auto-detect changes in
            directory structure automatically and help semi auto-installing
	            new directories (packages) for you.
</UL>



<P class="column7"><EM><STRONG>
       2.2.2 Automatic Info-default-directory-list configuration</STRONG></EM>

<P><UL>
	<LI>If you download packages that include Emacs info files,
            the <SAMP class="word">Info-default-directory-list</SAMP> is updated at the same time
            as the <SAMP class="word">load-path</SAMP>, when root directories are examined.
	<LI>No more manual updating of info files. The missing
            <SAMP class="word">dir</SAMP> entry is created or updated as needed.
	<LI>You can update all <STRONG class="word">new</STRONG> info files in your system by calling
	            M-x <SAMP class="word">tinypath-info-scan-Info-default-directory-list</SAMP>
</UL>



<P class="column7"><EM><STRONG>
       2.2.3 Automatic manpath configuration</STRONG></EM>

<P><UL>
	<LI>In Unix systems the MANPATH contains directories where to
            find manaual pages, but in Win32, there is no default
            MANPATH and <SAMP class="word">M-x</SAMP> <SAMP class="word">man</SAMP> does not work.
	<LI>If package <EM class="word">woman.el</EM> <A HREF="http://centaur.maths.qmw.ac.uk/Emacs/" target="_top">http://centaur.maths.qmw.ac.uk/Emacs/</A>
            is along <SAMP class="word">load-path</SAMP>, it is automatically configured to
            support to read manual pages. It replaces the <SAMP class="word">M-x</SAMP> <SAMP class="word">man</SAMP>
	            command.
</UL>



<P class="column7"><EM><STRONG>
       2.2.4 Win32 Cygwin environment support</STRONG></EM>

<P><UL>
	<LI>If <EM class="word">cygwin1.dll</EM> (See <A HREF="http://www.cygwin.com/)" target="_top">http://www.cygwin.com/)</A> is in your path,
            automatic detection tries to find the Cygwin root and scan
            manual and info pages for use with <EM class="word">woman.el</EM>
            available from Wright Francis <EM><A HREF="mailto:F.J.Wright@qmw.ac.uk" >F.J.Wright@qmw.ac.uk</A></EM>
	<LI>The other file hierarchies, like reed-kotler etc., are
	            also dealt with variable <SAMP class="word">tinypath-:extra-path-root</SAMP>.
</UL>



<P class="column7"><EM><STRONG>
       2.2.5 Compressed lisp file support</STRONG></EM>

<P><UL>
	<LI>Overloads commands LOAD, LOAD-LIBRARY, LOAD-FILE, REQUIRE
            and AUTOLOAD to accept <SAMP class="word">jka-compr</SAMP> compressed lisp .el files.
            This may include .Z .gz .z .bz2 files.
	<LI>Primarily meant to be used in low quota accounts.
	<LI>You don't have to change a thing in your Emacs startup file, all
            will work as usual.
	<LI>Correctly handles aliased commands that turn out to be
	            in <SAMP class="word">autoload</SAMP> state.
</UL>


</BLOCKQUOTE>
<hr>
    <A NAME="how_to_set_up_your">
    <H1>
    3.0 How to set up your load path
    
    </H1>
    </A>
<BLOCKQUOTE>
        The <SAMP class="word">tinypath-:load-hook</SAMP> contains function <SAMP class="word">tinypath-setup</SAMP> which
        starts examining all directories under <SAMP class="word">load-path</SAMP> and
        <SAMP class="word">tinypath-:load-path-root</SAMP> which is set to reasonable defalts of
        site wide and personal installations. If you keep all your lisp
        files under <EM class="word">$HOME/elisp</EM>, then you do not need to configure anything
        for this package to work. Your <SAMP class="word">load-path</SAMP> has been updated after
        this statement at the beginning of your $HOME/.emacs:

<PRE class="code">
      (load &quot;~/elisp/tiny/tinypath&quot;)   ;; Or where you have it installed
</PRE>


<P class="column8">
        If you have <STRONG class="word">many</STRONG> separate Emacs lisp root directories, like one
        for <EM class="word">site-lisp</EM> and one for <EM class="word">site-packages</EM> and one for your
        <EM class="word">personal</EM> <EM class="word">lisp</EM> files, then you have add those to variable
        <SAMP class="word">tinypath-:load-path-root</SAMP>. Below there is an example for PC users,
        where the E: partition replicates identical Unix tree structure.
        The following actually works for Unix too, because non-existing
        directories will be ignored:

<PRE class="code">
      (setq tinypath-:load-path-root
        '(&quot;~/elisp&quot;  &quot;E:/usr/share/emacs/site-lisp/common&quot;))
      (load (expand-file-name &quot;~/elisp/tiny/tinypath&quot;))
</PRE>


<A NAME="xemacs_and_emacs_specific_directories">
  <H2>
      3.1 XEmacs and Emacs specific directories
      
  </H2>
</A>


        In spite of great effort from developers to make packages
        compatible for both Emacs platforms, there is always some packages
        that only works with Emacs or XEmacs. It is assumed that admin has
        created directories like this to keep the site-lisp installation
        clean:

<PRE class="code">
      ;;   This might be also under /opt/share/site-lisp
      ;;   Refer to file hierarchy standard at
      ;;   <A HREF="http://www.pathname.com/fhs/" target="_top">http://www.pathname.com/fhs/</A>
</PRE>


<PRE class="code">
      /usr/share/site-lisp/common/   .. For Xemacs and Emacs
      /usr/share/site-lisp/emacs/    .. Packages only for Emacs
      /usr/share/site-lisp/xemacs/   .. Packages only for XEmacs
</PRE>


<P class="column8">
        To take care of the Emacs specific <SAMP class="word">load-path</SAMP> setting, use
        code similar to this code snippet. If you load this setup
        multiple times, the <SAMP class="word">pushnew</SAMP> ensures that the directories are not
        added multiple times.

<PRE class="code">
      (require 'cl)
      (dolist (path (&quot;~/elisp&quot;
                     &quot;/usr/share/emacs/site-lisp/common&quot;
                     ;;  Select Emacs or XEmacs specific installations
                     (if (boundp 'xemacs-logo)
                         &quot;/usr/share/site-lisp/xemacs&quot;
                       &quot;/usr/share/site-lisp/emacs&quot;)))
        (when (stringp path)
          (pushnew path tinypath-:load-path-root :test 'string=)))
      (pushnew &quot;~/elisp/tiny/lisp&quot; load-path :test 'stringp=)
      (load &quot;tinypath.el&quot;)
</PRE>


<P class="column8">
        In fact this package will check current emacs version and make sure
        that only correct directories are included to the <SAMP class="word">load-path</SAMP>. If
        you simply instructed to search the whole site-lisp root
        <SAMP class="word">/usr/share/site-lisp</SAMP>, and current emacs binary is &quot;emacs&quot;, then
        all directories that contain path portion <SAMP class="word">/xemacs</SAMP> are
        automatically ìgnored.

<A NAME="building_part_of_sitelisp_using">
  <H2>
      3.2 Building part of site-lisp using Net
      
  </H2>
</A>


        If we continue talking a bit more about site-lisp, you will find in
        the Tiny Tools kit an utility <EM class="word">bin/mywebget.pl</EM> and configuration
        file <EM class="word">mywebget-emacs.conf</EM> which contains current knowledge where
        the various lisp developers' home pages are and how to download all
        known lisp tools that does not come with Emacs. If you have lot of
        disk space and you're interesed in gettting more lisp tools to go
        with your Emacs, follow the instruction laid out in the
        configuration file. This usually means changing the configuration
        file's <STRONG class="word">ROOT</STRONG> directory where the download will happen. On disk,
        you are inclined to add few new file hierarchy levels:

<PRE class="code">
      /usr/share/site-lisp/net/users
      /usr/share/site-lisp/net/packages
</PRE>


<P class="column8">
        If you further are interested in Emacs packages, you should
        consider adding yet another hierarchy and investigate some of your
        time to download CVS version control software from
        <A HREF="http://www.cvshome.com/" target="_top">http://www.cvshome.com/</A> and would be ready to keep track of Gnus,
        BBDB and other package developments very effectively (minimizing
        network traffic) and timely fashion. It is suggested that you put
        all the CVS downloads under:

<PRE class="code">
      /usr/share/site-lisp/net/cvs-packages
</PRE>


<P class="column8">
        The overall structure of whole site list may look something like
        this. The CVS packages are mostly available at
        <A HREF="http://www.sourceforge.net/" target="_top">http://www.sourceforge.net/</A>

<PRE class="code">
      /usr/share/
               +--site-lisp/
                  +--emacs/
                  |  +--packages/
                  |  |  +--pcl-cvs-2.9.9/
                  |  +--win32/
                  |     +--gnuserv/
                  +--net/
                  |  +--users/
                  |  +--cvs-packages/
                  |     +--liece/
                  |     +--lookup/
                  |     +--ILISP/
                  |     +--jess-mode/
                  |     +--devel/
                  |     +--emacro/
                  |     +--tnt/
                  |     +--cc-mode/
                  |     +--gnu/           FSF CVS server
                  |        +--w3/
                  |        +--url/
                  |     +--mailcrypt/
                  |     +--bbdb/
                  |     +--gnus/
                  +--common/
                  +--xemacs/
                     +--cvs-packages/
                        +--xemacs-packages/
</PRE>


<A NAME="xemacs_21.2_core_packages">
  <H2>
      3.3 XEmacs 21.2+ core packages
      
  </H2>
</A>


        The recent XEmacs versions ship with only the very basic
        installation. Lisp packages are distributed in separate archive
        <EM class="word">xemacs-packages</EM> (nick named SUMO due to its huge size). There is
        also <EM class="word">mule-packages</EM> and <EM class="word">site-packages</EM> archives. A built-in
        heuristics tries to guess the location of these by looking under and
        near your XEmacs installation:

<PRE class="code">
      .../XEmacs/XEmacs-NN.N/xemacs-packages
      .../XEmacs/xemacs-packages
</PRE>


<P class="column8">
        If the archives have been installed elswhere, you have to tell the
        location by defining following variable prior loading TinyPath. You
        can't put these to <SAMP class="word">tinypath-:load-path-root</SAMP> because this is
        special information that needs to present during the very initial
        bootup to find crucial packages like <EM class="word">jka-compr.el</EM>.

<PRE class="code">
      (setq tinypath-:core-emacs-load-path-list
            '(&quot;/usr/share/site-lisp/xemacs/semacs-packages&quot;
               &quot;/usr/share/site-lisp/xemacs/mule-packages&quot;
               &quot;/usr/share/site-lisp/xemacs/site-packages&quot;))
</PRE>


<A NAME="finding_loadpath_directories">
  <H2>
      3.4 Finding load-path directories
      
  </H2>
</A>


        If you only used default $HOME/elisp directory for your files, the
        <SAMP class="word">tinypath-:load-path-function</SAMP> starts recursively searching all
        the directories under the root(s) <SAMP class="word">tinypath-:load-path-root</SAMP>. Not all
        directories are counted in when the search descends below the root(s).
        Variable <SAMP class="word">tinypath-:load-path-ignore-regexp</SAMP> decides if the directory
        should be ignored. By default:
<P><UL>
	<LI>Package's additional subdirectories like texinfo, tex, doc, etc,
            misc, RCS, CVS, zip are ignored.
	<LI>Any temporary directories named .../t/ .../T/ .../tmp* .../temp*
            are ignored.
	<LI>Directories that do not contain any files ending to .el or .elc are
	            ignored.
</UL>



<A NAME="gnus_and_other_3rd_party">
  <H2>
      3.5 Gnus and other 3rd party packages
      
  </H2>
</A>



<P class="column10"><EM class="quote10">
          <STRONG class="word">NOTE:</STRONG> in the latest version <EM class="word">Gnus</EM> is treated specially. All
          Gnus versions are detected along load-path and the very latest
          Gnus version is installed to your <SAMP class="word">load-path</SAMP>. This is based on
          the knowledge in the <SAMP class="word">gnus-version</SAMP> variable and the heuristics
          will pick the newest for you. You actually do not have to do
          anything else, but to drop latest Gnus somewhere, to be able to
          use it immedately.</EM>


<P class="column8">
        It is important to understand how this package works: It caches
        every possible lisp directory it can find. Now, if you have
        installed private copy of Gnus, say in <SAMP class="word">~/elisp/cvs-packages/gnus</SAMP>,
        there is a problem, because Emacs distribution also includes Gnus.
        There is NO WAY TO TELL OR CHANGE path order when the cache is in
        use. This is a design decision and cannot be changed. The old trick,
        where a new directory was added in front of <SAMP class="word">load-path</SAMP>, will not
        work because everything goes through cache. What you need to do
        instead, is to tell that the &quot;other&quot; Gnus should be ignored during
        cache creation, so that it is completely unknown.

<P class="column7"><EM><STRONG>
       3.5.1 Solution: ignoring directories</STRONG></EM>


<P class="column8">
        There is very simple way. Put your regular expression to
        <SAMP class="word">tinypath-:ignore-file-regexp-extra</SAMP> and it will tell which
        directories to ignore. Naturally you must put the lisp code
        <STRONG class="word">before</STRONG> you load package.

<PRE class="code">
      (setq tinypath-:load-path-ignore-regexp-extra
            &quot;\\|[/\\]x?emacs[/\\0-9.]+[/\\]lisp[/\\]gnus&quot;)
      (require 'cl)
      ;; location of tinypath.el
      (pushnew &quot;~/elisp/tiny/lisp&quot; load-path :test 'stringp=)
      (load &quot;tinypath.el&quot;)
</PRE>


<P class="column8">
        <SPAN class="word-ref">[For advanced Lisp programmers]</SPAN> You can add ignored gnus directory
        to <SAMP class="word">tinypath-:load-path-ignore-regexp</SAMP> via
        <SAMP class="word">tinypath-:load-path-ignore-regexp-hook</SAMP>. When the hook is run, the
        default value for <SAMP class="word">tinypath-:load-path-ignore-regexp</SAMP> is already
        available. In hook, append regular expression that excludes the
        Gnus directory. Here is an example; make sure that you don't add
        the regexp multiple times. The multiple invocations is protected by
        setting a plist property and checking it. The ugly <SPAN class="word-ref">[\\/]</SPAN> makes the
        regexp compatible with both Unix and win32 paths. System
        directories in Unix are typically /emacs/NN.NN/ and in win32
        /emacs-NN.NN/, that's why added &quot;-&quot;.

<PRE class="code">
      (add-hook 'tinypath-:load-path-ignore-regexp-hook
                'my-tinypath-:load-path-ignore-regexp-hook)
</PRE>


<PRE class="code">
      (defun my-tinypath-:load-path-ignore-regexp-hook ()
        ;;  Do this only once
        (unless (get 'my-tinypath-:ignore-file-regexp 'set)
          (put 'my-tinypath-:ignore-file-regexp 'set t) ;; mark as done.
          (setq tinypath-:load-path-ignore-regexp
                (concat
                 tinypath-:load-path-ignore-regexp
                 &quot;[/\\]x?emacs[/\\0-9.]+[/\\]lisp[/\\]gnus&quot;))))
</PRE>


<P class="column8">
        #todo: What about XEmacs public/private Gnus installations ?

<A NAME="updating_new_lisp_package">
  <H2>
      3.6 Updating new lisp package
      
  </H2>
</A>


        Suppose you have installed a new version of a package:

<PRE class="code">
      ~/elisp/gnus/pgnus-0.74/
      ~/elisp/gnus/pgnus-0.95/    ;; NEW
</PRE>


<P class="column8">
        Both these directories end up being added to the <SAMP class="word">load-path</SAMP>, but
        that is not preferrable. It is the latest version that should be in
        the <SAMP class="word">load-path</SAMP>. The solution is to move the old versions under
        some directory name that will be ignored by default. It is
        recommended that a backup of previous packages are renamed to start
        with a word &quot;tmp-&quot;:

<PRE class="code">
      % mv ~/elisp/gnus/pgnus-0.74/ ~/elisp/gnus/tmp-pgnus-0.74/
</PRE>


<P class="column8">
        Since all directories that start with prefix <EM class="word">tmp</EM> are ignored, the
        problem has been solved. However if you update package in a
        site-lisp directory, there may be a distant problem that somebody
        needs older version of the package. If you made the backup like
        above, that user cannot load the old package any more, because it
        doesn't show up in <SAMP class="word">load-path</SAMP>

<P class="column10"><EM class="quote10">
          There is no easy answer how to solve this. Admin could announce
          that: &quot;new version has been installed in DIR, the old one is in
          TMP-OLD-DIR&quot; and have users manually arrange their <SAMP class="word">load-path</SAMP> if
          needed. Following simple lisp command would solve their setup.
          The statement below adds the old directory to the <EM class="word">beginning</EM> of
          <SAMP class="word">load-path</SAMP> and load commands would find the old version of the
          package first.</EM>


<PRE class="code">
      (load (expand-file-name &quot;~/elisp/tiny/tinypath&quot;))
      (pushnew TMP-OLD-OLD-DIR load-path :test 'string=)
      (tinypath-cache-regenerate)
</PRE>


<P class="column8">
        Remember to mention to users that they need to update cache with
        <SAMP class="word">tinypath-cache-regenerate</SAMP> (called with prefix argument) to see
        the changes.

<A NAME="duplicate_files_in_path">
  <H2>
      3.7 Duplicate files in path
      
  </H2>
</A>


        If you have accustomed to putting your path to specific order, you
        have to rethink your strategy if you are going to use this package.
        The philopsophy behind creating this utility was: YOU SHOULD NOT
        NEED TO DO MANUAL WORK TO UPDATE PATHS. This means that the order of
        the paths <EM class="word">must</EM> not be significant. Now, You may face a situation
        where you install a library or package that contains a file, which
        has already been installed to your hierarchy. Take for example,
        <EM class="word">smtpmail.el</EM>:

<PRE class="code">
      /usr/local/bin/emacs-20.4/lisp/mail/smtpmail.el
      /usr/share/site-lisp/common/packages/semi/flim-1.12.1/smtpmail.el
</PRE>


<P class="column8">
        We have a problem here if FLIM's <EM class="word">smtpmail.el</EM> is not compatible with
        the Emacs's. If it is, then there is no problem. Either one can be
        loaded, and the <SAMP class="word">load-path</SAMP> order does not matter. But you don't
        know that before you get error &quot;function smtpmail-xxxx not defined&quot;
        and you start investigating with (locate-library &quot;smtpmail&quot;) which
        package is actually active.

<P class="column8">
        After installing this package, please investigate your path with
        <SPAN class="word-ref"><SPAN class="word-ref">[C-u]</SPAN></SPAN> <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypath-cache-problem-report</SAMP> and if you find many
        duplicate entries, investigate each one and possibly move the file
        to another name or remove old one. E.g. in the above situation, the
        cure might be moving FLIM's <EM class="word">smtpmail.el</EM> under name
        <EM class="word">tmp-smtpmail.el</EM> so that it doesn't get loaded with (require
        'smtpmail). The best is to contact the maintainer(s) and tell about
        conflicts. Here is a sample of the generated problem report:

<PRE class="code">
      imenu.el
        323 34073 1998-05-07 16:28:08 e:/usr/share/site-lisp/common/other/
        910 37169 1999-12-04 02:47:58 e:/usr/share/site-lisp/common/programming/java/jde/jde-2.1.6beta13/lisp/
        1350 38663 1999-11-28 01:14:38 e:/usr/local/bin/emacs/gnu-emacs/emacs-20.4.1/lisp/
      base64.el
        515  9943 1999-12-11 19:15:20 e:/usr/share/site-lisp/common/packages/gnus-5.8.2/lisp/
        807  9892 1999-11-15 00:00:12 e:/usr/share/site-lisp/common/packages/w3-4.0pre.46/lisp/
</PRE>


<P class="column8">
        <STRONG class="word">Explanation:</STRONG> User had used <EM class="word">imenu</EM> as a separate package since
        19.28 in &quot;other&quot; directory. The latest Emacs already ships with
        one, so it is best to delete the offending <SAMP class="word">other/imenu.el.</SAMP> Keep on
        eye on the numbers here: The lower, the more close it is to the
        beginning of cache when the directories were searched. The Package
        with lowest score will get loaded. For base64 there seems to be no
        problem. Gnus path has lowest score, it is the current latest
        development version, so it will get loaded before w3's base64. A
        simple major mode <SAMP class="word">tinypath-report-mode</SAMP> is turned on for this
        buffer. Unnecessary files can be deleted with
        <SAMP class="word">Control-shift-mouse-1</SAMP> or <SAMP class="word">C-c</SAMP> <SAMP class="word">C-d</SAMP>.

<A NAME="symlinked_directories_are_ignored">
  <H2>
      3.8 Symlinked directories are ignored
      
  </H2>
</A>


        It is traditional to use symlinks a lot in Unix to arrange easy
        access to versioned packages. Here is the traditional way how you
        can always refer to ~/elisp/gnus/ no matter what version is
        currenly installed.

<PRE class="code">
      ln -s ~/elisp/packages/gnus-N.NN  ~/elisp/packages/gnus
</PRE>


<P class="column8">
        This package however <EM class="word">skips</EM> those symlinks and records the
        absolute path name to the <SAMP class="word">load-path</SAMP>. There are couple of points:
        a) it is more instructive to peek the <SAMP class="word">load-path</SAMP> to actually see
        what versions have been installed to the Emacs b) The symlinks are
        error prone since there may be several symlinks that lead to same
        directory. In general, it is not a problem that the symlink
        directory is not included in the <SAMP class="word">load-path</SAMP>. There is one
        situation where symlink causes trouble for this package:

<P class="column10"><EM class="quote10">
          If you draw a symlink to the the current directory from
          <EM class="word">SEPARATE</EM> directory, then that directory will never be seen:</EM>


<PRE class="code">
      ln -s ~/some-disk/elisp/artist-1.1/ ~/elisp/packages/artist-1.1
</PRE>


<P class="column8">
        You shouldn't do this, instead either <STRONG class="word">a)</STRONG> move the package
        physically under the ~/elisp/ from the ~/some-disk/elisp/ so
        that the recursive search will record it or <STRONG class="word">b)</STRONG> add the
        separate directory ~/some-disk/elisp to the
        <SAMP class="word">tinypath-:load-path-root</SAMP>.
</BLOCKQUOTE>
<hr>
    <A NAME="using_cache">
    <H1>
    4.0 Using cache
    
    </H1>
    </A>
<BLOCKQUOTE>
        Now when you're freed from update burden of the directories in your
        disk, you can concentrate organising the files under sensible
        directories. Here is an example how the organizing could go:

<PRE class="code">
      ~/elisp/users/kevinr/       Kevin Rodger's files
      ~/elisp/users/ilya/         Ilya Zakharevich's files
      ..
      ~/elisp/packages/bbdb-2.00.06/  Versioned packages
      ~/elisp/packages/psgml-1.0.3/
      ~/elisp/packages/pcl-cvs-2.9.2/
      ~/elisp/packages/tiny-19990215/
      ...
      ~/elisp/mime/               All MIME relates packages under this
      ~/elisp/mime/semi/          SEMI packages
      ~/elisp/mime/tm/            TM packages
</PRE>


<PRE class="code">
      ~/elisp/lcd/                LCD (lisp code) hierarchy
      ~/elisp/lcd/misc/           <A HREF="http://www.cs.indiana.edu/LCD/" target="_top">http://www.cs.indiana.edu/LCD/</A>
      ~/elisp/lcd/functions/
      ...
      ~/elisp/other/              All single add-on packages
</PRE>


<P class="column8">
        All these paths in <SAMP class="word">load-path</SAMP> and you can imagine how slow a
        standard Emacs would become: it takes even more time to find some
        package xxx, when Emacs sees a call (require 'xxx), because Emacs
        must start looking into every single directory under <SAMP class="word">load-path</SAMP>
        until it can determine if it can or cannot load the asked package.
        This utility will store all lisp files in cache, and it is
        activated by default. The variable <SAMP class="word">tinypath-:cache-expiry-days</SAMP>
        controls the interval when it is concluded that a new tree
        recursion is needed. If you install new packages during those
        non-expiry days, it is best to call <SAMP class="word">C-u</SAMP> <SAMP class="word">M-x</SAMP>
        <SAMP class="word">tinypath-cache-regenerate</SAMP> to build up to date image of your files
        and <SAMP class="word">load-path</SAMP> directories.

<P class="column10"><EM class="quote10">
          If you want one short advice: always call
          <SAMP class="word">tinypath-cache-regenerate</SAMP> after any lisp file or directory
          update.</EM>


<A NAME="cache_file_and_different_emacs">
  <H2>
      4.1 Cache file and different Emacs versions
      
  </H2>
</A>


        It is important that each Emacs loads correct cache file. The
        cache file's name is derived from the emacs version. The emacs
        type is &quot;xemacs&quot; &quot;win32-xemacs&quot; &quot;emacs&quot; or &quot;win32-emacs&quot;.

<PRE class="code">
      tinypath-:cache-file-prefix
      + EMACS-TYPE
      + HOST
      + EMACS-VERSION
      + tinypath-:cache-file-postfix
</PRE>


<PRE class="code">
      ~/elisp/config/emacs-config-tinypath-cache-win32-HOST-emacs-20.4.1.el.gz
      ==========================================                        ======
      prefix                                                           postfix
</PRE>


<P class="column7"><EM><STRONG>
       4.1.1 Unix hosts and NFS mounts</STRONG></EM>


<P class="column8">
        In Unix environment, it is also common that several hosts are NFS
        mounted so that your home disk is available from every server. The
        available programs are not usually NFS mounted, but programs are
        stored locally on each server's own disk. Now, there would be a
        problem if you logged to host <EM class="word">A</EM> and started tinypath.el which had
        made cache in on host <EM class="word">B</EM>, because <EM class="word">A</EM> does not have the same
        directories as <EM class="word">B</EM> did (site-lisp) are visible. This has been taken
        care of by including <STRONG class="word">hostname</STRONG> part in the cache file name. For
        each host, a separate cache file is created. Now, suppose all the
        Unix hosts are same brand, say SunOS, Linux, or HP-UX and a good
        adminstrator has separated the programs and the data in their own
        directory structures. Furthemore, these structures are NFS mounted
        and thus visible to the remote machines. In this scenario, it would
        not really matter to which host you log into, because you would
        always see the same programs and site-lisp directories and there
        would not be need for host specific cache files. In that case,
        disable the <EM class="word">HOST</EM> word by writing a simple function which will
        return an empty string &quot;&quot;:

<PRE class="code">
      (setq tinypath-:cache-file-hostname-function '(lambda () &quot;&quot;))
</PRE>


<A NAME="info_file_support">
  <H2>
      4.2 Info file support
      
  </H2>
</A>


        In addition to updating the <SAMP class="word">load-path</SAMP>, the recursive function
        has a chance to search for installed info files as well. When you
        keep all your site lisp under one directory, it is not uncommon
        that the bigger packages include documentation files in info format
        as well. Like:

<PRE class="code">
      /usr/share/site-lisp/emacs/pcl-cvs-2.9.9
      /usr/share/site-lisp/common/packages/psgml-1.2.1
</PRE>


<P class="column8">
        One possibility is that after you download and uncompressed
        package, you would copy the info file to some central directory
        where you keep all you info files. This is lot of manual work.
        (Never mind that in Unix you might use Makefile to install
        everything, in Win32 it's all manual work). This package
        do the same job by lokking for directories that either have info files
        or a central info repository called <SAMP class="word">dir</SAMP>. If the repository has all the
        info files up to date, nothing is done. In other cases:
<P><UL>
	<LI>If the central <SAMP class="word">dir</SAMP> in the directory does not exits,
            it is created.
	<LI>If <SAMP class="word">dir</SAMP> does not contain entry for info file, it is added.
	            The entry name is derived from the filename.
</UL>



<P class="column8">
        The <SAMP class="word">Info-default-directory-list</SAMP> is updated to include any new
        directory locations and they are saved to same cache file. When you
        call <SAMP class="word">C-h</SAMP> <SAMP class="word">i</SAMP> you will see the new info entries. Easy and
        maintenance friendly. No need to worry about supplied info files any
        more, they are automatically integrated to your Emacs. If you have
        installed any new packages to your system, Emacs packages or Unix
        packages that installed something with &quot;install -c&quot;, it is best to
        update your info files with <SAMP class="word">M-x</SAMP>
        <SAMP class="word">tinypath-info-scan-Info-default-directory-list</SAMP>. This is also
        called if you call: <SAMP class="word">C-u</SAMP> <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypath-cache-regenerate</SAMP>

<A NAME="cygwin_suport_win32_and_woman.el">
  <H2>
      4.3 Cygwin suport (Win32 and woman.el)
      
  </H2>
</A>


        It is common that Emacs in win32 environment is coupled with
        Cygwin toolkit which contains all the manual pages for the unix
        commands and possibly new info pages. This package will locate
        <SAMP class="word">cygwin1.dll</SAMP> file along PATH and recurse whole cygwin installation
        root to find new entries that can be used inside Emacs. In theory
        this all should happen automatically and the only thing you have to
        do is to ensure that you have proper PATH settings at your OS level
        before this package is started. If Cygwin /bin directory in in
        PATH, <SAMP class="word">tinypath-:extra-path-root</SAMP> will get set to a correct value at
        boot time.

<P class="column8">
        If you have more places where you keep Unix tools which contain
        more manual or info pages, like Reed Kotler
        <A HREF="http://www.reedkotler.com/" target="_top">http://www.reedkotler.com/</A> you <STRONG class="word">must</STRONG> manually set variable
        <SAMP class="word">tinypath-:extra-path-root</SAMP> to the list of search root directories.
        If you set this yourself, you <STRONG class="word">must</STRONG> also include the cygwin
        installation root directory

<PRE class="code">
      (setq tinypath-:extra-path-root
            '(&quot;e:/unix-root/cygwin&quot;
              &quot;e:/unix-root/reed-kotler&quot;
              ...))
</PRE>


<P class="column8">
        Package <EM class="word">woman.el</EM> will be configured automatically if it is along
        <SAMP class="word">load-path</SAMP> to handle your manual page viewing with command <SAMP class="word">M-x</SAMP>
        <SAMP class="word">man</SAMP>. Please make sure that you do not destroy the pre-defined
        <SAMP class="word">woman-manpath</SAMP> in your Emacs startup files with lisp commands or
        the efforts to find out new manual pages are thrown off the window.
        Search you startup files for anything that looks like <SAMP class="word">setq</SAMP>,
        <SAMP class="word">defvar</SAMP>, <SAMP class="word">defconst</SAMP>: (setq woman-manpath ... and change the code
        to <STRONG class="word">add</STRONG> to the variable instead:

<PRE class="code">
      (require 'cl)
      (dolist (path '(&quot;one&quot; &quot;two&quot; &quot;three&quot;))
        (pushnew (expand-file-name path) woman-manpath :test 'string))
</PRE>

</BLOCKQUOTE>
<hr>
    <A NAME="faster_emacs_configuration_perl_emacsutil.pl">
    <H1>
    5.0 Faster Emacs configuration (Perl emacs-util.pl)
    
    </H1>
    </A>
<BLOCKQUOTE>
        Indication of this feature at startup is following message, where
        EXT refers to externally launched process which must be waited
        until further processing is done.

<PRE class="code">
      Tinypath: EXT Process running ... [may takea while]
</PRE>


<P class="column8">
        As this package evolved and more support was added to various
        environments, like Cygwin, which requires travesing hundread of
        directories to find out if they containes info or manual pages,
        it came evident that Emacs Lisp method is too slow. An alternative
        method was developed using Perl language to write <EM class="word">emacs-util.pl</EM>
        which can traverse directory hierarchies to find relevant
        directories for the setup. This interface is automatically used
        if two conditions are met in current environment:
<P><UL>
	<LI>Binary <EM class="word">perl</EM> must be along PATH. (according  <SAMP class="word">executable-find</SAMP>)
	<LI>perl script <EM class="word">emacs-util.pl</EM> must be along PATH. Either copy
            the file to suitable place or include tiny-tool kit's /bin
            directory to your PATH (This is not the whole story, see
	            &quot;Internal optimizations&quot;).
</UL>



<P class="column8">
        If all goes well, a <SAMP class="word">call-process</SAMP> to the utility script will
        return the file hierarchies much faster than the Emacs Lisp ever
        could. The difference is that you don't see the traversing progress
        as you would if Emacs Lisp did the same thing. The command line
        arguments passed to the utility scripts can be found from the
        <EM class="word">Message</EM> buffer and you can run the program yourself if you think
        that it returns incorrect listing. Print the script help with
        options (In win32 you have have to put perl interpreter in front,
        Unix only needs +x and you can run the program)

<PRE class="code">
      % perl emacs-util.pl --help
</PRE>


<P class="column8">
        Here are some performance statistics of the perl script in action.
        (Use --verbose argument to see the statstics)
<P><UL>
	<LI>Intel 400Mhz, IBM GXP 80G IDE disk, whole Cygwin installation
            scan: 3 min 46 sec, dirs: 2373, files: 35 271
	<LI>Same PC, but this time site-lisp directory, subset of Cygwin
            hierarchy at /usr/share/site-lisp took:
	            0 min 13 sec, dirs: 648, files: 8750
</UL>



<P class="column8">
        Let's consider one scenario that you may encounter if you intend
        to use Cygwin like the big brother Linux. Let's suppose that you
        have a dedicated disk portion where you intend to duplicate whole
        Linux-like directory hierarchy. You have ROOT under which you keep
        all the files, including anything that is Cygwin-related.

<PRE class="code">
      E:/usr/share/site-lisp      Emacs lisp as outlined earlier
      E:/usr/share/site-perl      Perl packages and scripts
      E:/usr/share/site-php       PHP code
      E:/usr/share/site-cvs       Various other external CVS C-packages
</PRE>


<P class="column8">
        The default heuristics <SAMP class="word">win32-cygwin-p</SAMP> should find <EM class="word">cygwin1.dll</EM>
        installed and report that Cygwin root is <EM class="word">E:/</EM> This means that
        <SAMP class="word">tinypath-:extra-path-root</SAMP> will get set for you when package
        loads. Suppose furher that you have set variable
        <SAMP class="word">tinypath-:load-path-root</SAMP> to point ot suitable locations in
        <EM class="word">E:/usr/share/site-lisp</EM>. It would seem that this combination means
        that the hierarchies would be traversed multiple times, since the
        Cygwin root already includes all the rest:

<PRE class="code">
      E:/                             Cygwin root
      E:/usr/share/site-lisp/emacs    For this emacs...
      E:/usr/share/site-lisp/common   Emacs and XEmacs copatible tree
</PRE>


<P class="column8">
        Don't worry. The Perl utility is smart enough to reduce this to
        search only <EM class="word">E:/</EM> and discard other roots as redundant. Hm, what if
        other lisp files are found <STRONG class="word">outside</STRONG> of the
        <EM class="word">E:/usr/share/site-lisp/</EM>, because it searches every dir starting
        from <EM class="word">E:/</EM> Say:

<PRE class="code">
      E:/tmp/try/some-file.el
</PRE>


<P class="column8">
        Will the directory <EM class="word">E:/tmp/try/</EM> reported as lisp <SAMP class="word">load-path</SAMP>
        candidate and added to search list? Yes and no. Yes, it will be
        reported, but No, it will not be added to the <SAMP class="word">load-path</SAMP> because it
        doesn't match the initial user's idea where to look for lisp files. If
        you pump up the <SAMP class="word">tinypath-:verbose</SAMP> to level 5, you can see PATH-NOK
        messages labelled &quot;candidate&quot; that are those rejections. Only files
        that reside under <SAMP class="word">tinypath-:load-path-root</SAMP> directories are counted
        in.

<A NAME="updating_running_emacs">
  <H2>
      5.1 Updating running Emacs
      
  </H2>
</A>


        Suppose you have downloaded the latest versions of packages X, Y and Z
        and you want your current emacs's paths updated. You can do this:

<PRE class="code">
      M-x tinypath-cache-regenerate
</PRE>


<P class="column8">
        A bit of sceptism: It is a fortunate event if it all worked that
        easily. You see, you already have several packages loaded in your
        Emacs and they are using the &quot;old&quot; code. Now you wiped the old
        directories away and told Emacs to look for only &quot;new&quot; directories.
        After a while you may run into bizarre dependency problems. I
        recommend that after a major package update that has lot of files
        (like Gnus), you:
<P><UL>
	<LI> Intsall package and regenerate cache in current Emacs with
             <SAMP class="word">M-x</SAMP> <SAMP class="word">tinypach-cache-regenerate</SAMP>.
	<LI> Save your  current session (see <EM class="word">desktop.el</EM>, <EM class="word">tinydesk.el</EM>)
	<LI> Quit, and restart Emacs
</UL>


</BLOCKQUOTE>
<hr>
    <A NAME="compressed_lisp_file_support">
    <H1>
    6.0 Compressed lisp file support
    
    </H1>
    </A>
<BLOCKQUOTE>
        IN ORDER TO USE THE FULL COMPRESSION SUPPORT FOR AUTOLOAD FUNCTIONS
        AS WELL, SET VARIBALE <SAMP class="word">tinypath-:compression-support</SAMP> to symbol
        <SAMP class="word">all</SAMP>. THE DEFAULT SUPPORT ONLY HANDLES <SAMP class="word">require</SAMP> and <SAMP class="word">load</SAMP> commands.
        You must set this variable before package loads.

<A NAME="jkacompr_and_this_package">
  <H2>
      6.1 Jka-compr and this package
      
  </H2>
</A>


        jka-compr has native support to un/compress any file that has
        specific extension. The handling is done via
        <SAMP class="word">file-name-handler-alist</SAMP> and commands like these will load
        properly, including any autoloads.

<PRE class="code">
      (load &quot;my-el.gz&quot;)
</PRE>


<P class="column8">
        The obvious problem is that you have to manually go and change all
        you load commands so that they end in .gz so that jka-compr takes
        care of loading. What if you later uncompress the file? You have to
        go and update all the load commands in you Emacs startup files.
        This isn't very nice, since you should be able to un/compress elisp
        files whenever you wish and still have permanent statement like one
        below. Basicly this is what the compression support here is all
        about; you don't have to worry if the file is compressed or not
        when these advised functions are in effect. The following statement
        will always work:

<PRE class="code">
      (load &quot;my-el&quot;)
</PRE>


<A NAME="how_the_compressed_loading_works">
  <H2>
      6.2 How the compressed loading works
      
  </H2>
</A>


<P><UL>
	<LI>When user request <SAMP class="word">load</SAMP> FILE, try to find some compressed file
            that JKA knows about by adding extensions &quot;.gz&quot; and &quot;.Z&quot; and
            whatever user has configured JKA to handle. <STRONG class="word">LIMITATION:</STRONG>
            only .gz .Z .bz2 and the like that compress one file at a time
            is currently supported. Don't try using .zip or similar.
	<LI>If the FILE is absolute path, then look from that
            directory only.
	<LI>If no directory is given, find the file along the path.
	<LI>If there was somewhere a compressed file, just load it (because JKA
            will transparently uncompress it), eval it, and kill the buffer.
	<LI>If NO COMPRESSED file was found, just follow normal
	            emacs rules.
</UL>



<P class="column7"><EM><STRONG>
       6.2.1 Note: Why you should not prefer compressed .elc files</STRONG></EM>


<P class="column8">
        The purpose of compression support is to make it possible to have
        more useful lisp files in an account that has a limited disk space (quota).
        Keeping lisp files in compressed format saves quite a much disk space.
<P><UL>
	<LI>Plain text, lisp <SAMP class="word">.el</SAMP>, files may compress better.
	<LI>The documentation in comments is important, e.g all the
            instruction to use the file are there. Byte compiling
            strips away documentation.
	<LI>In order to debug or send bug reports you have to use .el files,
            the .elc files are useless.
	<LI>The performance ratio that the .elc files offer may not
	            be a crucial factor (many times you couldn't tell).
</UL>



<A NAME="note_adviced_emacs_commands">
  <H2>
      6.3 Note: adviced emacs commands
      
  </H2>
</A>


        If any of the standard emacs functions handled here get overloaded,
        ie. replaced with someone else's definition of that function, it'll
        break this package. The problem may not become visible, if the
        redefined function doesn't use <SAMP class="word">interactive-p</SAMP> function- The reason
        why the adviced functions here cannot be redefined is that advice's
        <SAMP class="word">ad-do-it</SAMP> cannot pass the interactive flag information to the
        original functions.
</BLOCKQUOTE>
<hr>
    <A NAME="implementation_notes">
    <H1>
    7.0 Implementation Notes
    
    </H1>
    </A>
<BLOCKQUOTE>

<A NAME="code_note_general">
  <H2>
      7.1 Code note: General
      
  </H2>
</A>


        Because this package is among the first that is loaded from
        Emacs startup file, It contains copies of some functions from
        TinyLib libraries, to make the package independent until the
        point where the <SAMP class="word">load-path</SAMP> has been set up and other
        libraries are available. In the code you may find marks
        &quot;#copy:&quot; which indicate code that has been copied/simplified
        to be used here. Autoloads statements in this package defer
        loading functions until the end is reached and <SAMP class="word">load-path</SAMP> is
        determined and the rest of the functions can be loaded from the
        libraries.

<A NAME="code_note_where_is_that">
  <H2>
      7.2 Code note: Where is that emacs package
      
  </H2>
</A>


        If you ever need to know the location of a package that Emacs
        would load or has loaded, while this utility is in effect,
        use this call:

<PRE class="code">
      (insert (tinypath-cache-p &quot;gnus.el&quot;))
</PRE>


<P class="column8">
        More easily, if you have tinylisp.el, which takes advantage of
        tinypath.el cache, you can load any emacs package for editing
        with command:

<PRE class="code">
      M-x load-library RET tinylisp RET
      M-x tinylisp-library-find-file
      (tinypath cache)Lisp Library: gnus.el RET
</PRE>


<P class="column8">
        Altenatively there is mode hotkeys $ l f  and $ l p :

<PRE class="code">
      M-x load-library RET tinylisp RET
      M-x tinylisp-mode  (in *scratch* buffer, see &quot;E&quot; in modeline)
      $ l f
      (tinypath cache)Lisp Library: gnus.el RET
</PRE>


<A NAME="code_note_internal_optimizations">
  <H2>
      7.3 Code note: Internal optimizations
      
  </H2>
</A>


        In the installation section it is instructed that the location of
        the package is pushed into the <SAMP class="word">load-path</SAMP> before the package is
        loaded:

<PRE class="code">
      (require 'cl)
      (pushnew &quot;~/elisp/tiny/lisp&quot; load-path :test 'stringp=)
      (load &quot;tinypath.el&quot;)
</PRE>


<P class="column8">
        Please follow this instruction. The reason is that program tries to
        use most efficient code to boot everything up and the first thing
        it can do is to check the location where where it has been saved.
        Loading package with absolute name leaves trace to <SAMP class="word">load-history</SAMP>.
        This package will use this information to assume that the Perl
        program emacs-util.pl is available in
        <EM class="word">~/some/path/bin/emacs-util.pl</EM>. If that fails, the Perl program
        is searched along <SAMP class="word">exec-path</SAMP>. This is usually desirable, because
        every new installation include newer version of this utility and
        the one at <SAMP class="word">exec-path</SAMP> may not be up to date. The perl code will
        speed up booting compared to pure Emacs Lisp implementaton.

<A NAME="code_note_messages">
  <H2>
      7.4 Code note: *Messages*
      
  </H2>
</A>


        This package will print loads of messages to Emacs &quot;*Message*&quot; or
        XEmacs &quot; <EM class="word">Message-Log</EM>&quot; buffer. This is a design decisions so that
        execution can be easily traced during Emacs load time. It also help
        reporting errors. The default <SAMP class="word">tinypath-:verbose</SAMP> 3 will log the most
        important messages and even if you set the level to 0 or nil, still
        some messages are displayed. Have a look at that buffer if you have
        not much used it before. You may find interesting information to
        debug some of your own misconfirations, like stale directories
        in <SAMP class="word">exec-path</SAMP>.

<A NAME="code_note_custom">
  <H2>
      7.5 Code note: Custom
      
  </H2>
</A>


        If you have Emacs that does not contain <EM class="word">custom.elc</EM> (Yes, it must be
        in compiled format, be sure to check), you can download Noah
        Friedman's exellent custom emulation package <EM class="word">cust-stub.el</EM> at
        <A HREF="http://www.splode.com/~friedman/software/emacs-lisp/" target="_top">http://www.splode.com/~friedman/software/emacs-lisp/</A> You have to load
        it from absolute location before loading this packages like this:

<PRE class="code">
      (load &quot;~/elisp/noah/cust-stub&quot;)
      (load (expand-file-name &quot;~/elisp/tiny/lisp/tinypath&quot;))
</PRE>


<A NAME="todo">
  <H2>
      7.6 Todo
      
  </H2>
</A>


<P><UL>
	<LI>In theory it is possible to load remote files with ange-ftp/EFS
            in manner of load-library RET /user@host:/path/to/file but this
            has never been tested using this package.
	<LI>It is possible to add /user@host:/path/to/dir/ to <SAMP class="word">load-path</SAMP>,
            but that has never been tested.
	<LI><EM class="word">xemacs-packages</EM> can be downloaded using CVS. Hm, where would
            this cvs download be? Any chance to make autoboot coder that
	            too?
</UL>




<!---	......................................................................
	DOCUMENT END BLOCK
	......................................................................
--->

</BLOCKQUOTE>
<HR>
<EM    class="footer">
<P>
Copyright (c) 2001 by Jari Aalto. This material may be
distributed only subject to the terms and conditions set forth
in the Open Publication License, v1.0 or later (the latest
version is presently available at
http://www.opencontent.org/openpub/). Distribution of the work
or derivative of the work for commercial purposes in any
form is prohibited unless prior permission is obtained from
the copyright holder. (VI.B LICENSE OPTIONS)
<P>
This file has been automatically generated from plain text file
with perl script <STRONG>t2html.pl 1.27</STRONG><BR>
Document author: Jari Aalto<BR>
Contact: &lt;<A HREF="mailto:jari.aalto@poboxes.com">jari.aalto@poboxes.com</A>&gt;<BR>
Html date: 2001-08-04 16:51<BR>
</EM    class="footer">
</BODY>
</HTML>
